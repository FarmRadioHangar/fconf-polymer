<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="my-ethernet.html">
<link rel="import" href="my-wifi.html">
<link rel="import" href="my-4g.html">
<link rel="import" href="my-3g.html">

<dom-module id="my-interface">
	<template>
		<style include="shared-styles">
			:host {
				display: block;
				padding: 10px;
			}
		</style>
		<h1>Configure [[_interfaceType(interfaceType)]] interface [[name]]</h1>
		<!--paper-toggle-button disabled=[[_ifaceUsable(status)]] on-checked-changed="_enabledChanged" checked="[[enabled]]" notify>[[_ifaceStatus(status, enabled)]]</paper-toggle-button-->

		<template is="dom-if" if="[[_isType('ethernet', interfaceType)]]">
			<my-ethernet name="[[name]]" config=[[config]] enabled=[[enabled]] defaults=[[defaults]]></my-ethernet>
		</template>
		<template is="dom-if" if="[[_isType('wifi', interfaceType)]]">
			<my-wifi name="[[name]]" mode=[[mode]] ap=[[ap]] client=[[client]] enabled=[[enabled]] interfaces=[[_filterCurrentInterface(state.deviceList)]]></my-wifi>
		</template>
		<template is="dom-if" if="[[_isType('4g', interfaceType)]]">
			<my-4g name="[[name]]" mode=[[mode]] ndis=[[ndis]] enabled=[[enabled]]></my-4g>
		</template>
		<template is="dom-if" if="[[_isType('3g', interfaceType)]]">
			<my-3g name="[[name]]" config=[[config]] enabled=[[enabled]] defaults=[[defaults]]></my-3g>
		</template>
		<template is="dom-if" if="[[!interfaceType]]">
			Unknown interface, please specify type <paper-radio-group selected="{{_selected}}">
				<paper-radio-button name="ethernet">Ethernet</paper-radio-button>
				<paper-radio-button name="wifi">Wi-Fi</paper-radio-button>
				<paper-radio-button name="4g">4g modem</paper-radio-button>
				<paper-radio-button name="3g">3g modem</paper-radio-button>
			</paper-radio-group>
		<div>
			<paper-button raised on-tap="onSaveTap" disabled=[[_selected]]>Save</paper-button>
		</div>

		</template>

	</template>
	<script>
		Polymer({
			is: 'my-interface',
			behaviors: [
				UniFlow.StateAware,
				UniFlow.ActionEmiter,
			],
			
			_interfaceType(type) {
				switch (type) {
					case "wifi":
						return "Wi-Fi";
					default:
						return type;
				}
			},
			_filterCurrentInterface(interfaces) {
				var filtered = [];
				interfaces.forEach(function(interface) {
					if (interface.name !== this.name) {
						filtered.push(interface);
					}
				}.bind(this));
				return filtered;
			},
			_isType(type, value) {
				return type === value;
			},
			onSaveTap() {
				this.emitAction({
					type: 'interfaceType',
					name: this.name,
					interfaceType: this._selected,
				});
			},
			ready() {
				/*
					var myElement = document.createElement('my-' + this.interfaceType);
					myElement.name = this.name;
					myElement.statePath = "state.interfaces." + this.name;
					myElement.config = this.get(["state.interfaces", this.name, "config"]);
					//console.log('my interface ready', myElement.config, this.get("state.interfaces." + this.name));
					
					Polymer.dom(this.root).appendChild(myElement);
					*/
			},
		});
	</script>
</dom-module>
